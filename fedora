#!/usr/bin/env bash

#   
#   ███████╗███████╗██████╗  ██████╗ ██████╗  █████╗    
#   ██╔════╝██╔════╝██╔══██╗██╔═══██╗██╔══██╗██╔══██╗  
#   █████╗  █████╗  ██║  ██║██║   ██║██████╔╝███████║ 
#   ██╔══╝  ██╔══╝  ██║  ██║██║   ██║██╔══██╗██╔══██║   
#   ██║     ███████╗██████╔╝╚██████╔╝██║  ██║██║  ██║ 
#   ╚═╝     ╚══════╝╚═════╝  ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝
#                                                                                                                 

cd "$(dirname "${0}")"

read -r -p "Gnome? [y/N] " GNOME; echo;
read -r -p "KDE? [y/N] " KDE; echo;

# package manager update
sudo dnf -y upgrade

# extra repositories
sudo dnf -y install https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm
sudo dnf -y install https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm

# packages
sudo dnf -y install tlp
sudo dnf -y install alacritty 
sudo dnf -y install bat exa fd-find fzf ripgrep stow tldr 
sudo dnf -y install zsh zsh-autosuggestions zsh-syntax-highlighting starship
sudo dnf -y install neovim

if [[ ! $GNOME =~ ^[Yy]$ ]]; then
    sudo dnf -y install gnome-tweaks
    sudo dnf -y install gnome-shell-extension-pop-shell 
    sudo dnf -y install gnome-shell-extension-sound-output-device-chooser
    sudo dnf -y install gnome-shell-extension-caffeine
    sudo dnf -y install gnome-shell-extension-launch-new-instance
fi

if [[ ! $KDE =~ ^[Yy]$ ]]; then
    git clone git@github.com:Bismuth-Forge/bismuth.git ~/src/github.com/Bismuth-Forge/bismuth
    cd ~/src/github.com/Bismuth-Forge/bismuth
    npm install # Installs dependencies for building
    npm run sysdep-install # Install system dependencies for building
    npm run bi-install # Installs all Bismuth components
fi

# make zsh my default
sudo dnf -y install util-linux-user
chsh -s "$(which zsh)"

# dnf config
sudo echo "fastestmirror=True" >> /etc/dnf/dnf.conf
sudo echo "max_parallel_downloads=10" >> /etc/dnf/dnf.conf
sudo echo "defaultyes=True" >> /etc/dnf/dnf.conf

# manual
xdg-open https://mega.nz/sync &
